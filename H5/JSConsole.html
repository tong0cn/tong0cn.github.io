<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Console</title>
    <link rel="icon" href="/img/favicon1.ico" type="image/x-icon">
    
    <!-- å¼•å…¥ Monaco Editor èµ„æº -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/editor/editor.main.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2c3e50, #4a6491);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.8;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
            gap: 20px;
            /* overflow: scroll;  */
        }
        
        .panel {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .panel-header {
            background: #3498db;
            color: white;
            padding: 12px 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Monaco Editor å®¹å™¨æ ·å¼ */
        .editor-container {
            /* height: 400px; */
            height: 54vh;
            border-bottom: 1px solid #eaeaea;
        }
        
        .console-output {
            /* height: 399px; */
            height: 54vh;
            padding: 15px;
            background: #1e1e1e;
            color: #f0f0f0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-y: auto;
            white-space: pre-wrap;
            line-height: 1.4;
        }

        /* è¿è¡Œå—æ ·å¼ï¼šæ¯æ¬¡è¿è¡Œä½œä¸ºä¸€ä¸ªç‹¬ç«‹æŠ˜å é¢æ¿ */
        .run-block {
            /* border: 1px solid rgba(255,255,255,0.06); */
            /* background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); */
            margin: 8px 0;
            border-radius: 6px;
            overflow: hidden;
        }

        .run-block-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid rgba(255,255,255,0.02);
            font-size: 13px;
            color: #eee;
        }

        .collapse-btn, .delete-btn {
            padding: 3px 12px;
            font-size: 12px;
            margin-left: 4px;
            font-weight: normal;
        }

        .run-start {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* å…³é”®ï¼šå…è®¸æ¢è¡Œ */
        }

        .run-timeTxt {
            margin-right: auto;
        }

        .run-controls {
            display: flex;
            gap: 4px;
            flex-wrap: wrap; /* å…è®¸æŒ‰é’®æ¢è¡Œ */
            justify-content: flex-end; /* å³å¯¹é½ */
        }

        .run-block-controls button {
            margin-left: 6px;
            padding: 6px 10px;
            font-size: 12px;
        }

        .run-block-body {
            padding: 6px 2px;
            font-family: monospace;
            font-size: 13px;
            color: #fff;
            white-space: pre-wrap;
            max-height: 40vh;
            overflow: auto;
            background: rgba(0,0,0,0.3);
        }

        /* æŠ˜å åŠ¨ç”»ï¼šcollapsed æ—¶å°† body é«˜åº¦æŠ˜å ä¸º 0ï¼Œå¹¶éšè—ç»“æŸè¡Œ */
        .run-block-body.collapsed {
            max-height: 0 !important;
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            overflow: hidden !important;
            transition: max-height 220ms ease-out, padding 200ms ease-out;
        }

        .run-end.collapsed {
            max-height: 0;
            opacity: 0;
            transition: opacity 200ms ease-out, max-height 200ms ease-out;
            height: 0;
            overflow: hidden;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: #f5f7fa;
            border-top: 1px solid #eaeaea;
        }
        
        .color-controls {
            height: 68px;
            display: flex;
            gap: 10px;
            padding: 10px 15px;
            background: linear-gradient(to right, #2c3e50, #4a6491);
            border-top: 1px solid #34495e;
            align-items: center;
            overflow: auto;
        }
        
        .color-label {
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .run-btn {
            background: #2ecc71;
            color: white;
        }
        
        .run-btn:hover {
            background: #27ae60;
        }
        
        .clear-btn {
            background: #3498db;
            color: white;
        }
        
        .clear-btn:hover {
            background: #2980b9;
        }
        
        .example-btn {
            background: #e74c3c;
            color: white;
        }
        
        .example-btn:hover {
            background: #c0392b;
        }
        
        /* é¢œè‰²æ§åˆ¶æŒ‰é’®æ ·å¼ */
        .color-btn {
            /* padding: 6px 20px; */
            padding: 6px clamp(10px, calc(10px + (100vw - 769px) * (10 / 1151)), 20px);
            border: 2px solid transparent;
            border-radius: 4px;
            /* font-size: 12px; */
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .color-btn.active {
            border-color: #fff;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        
        .color-white {
            background: #ffffff;
            color: #333;
        }
        
        .color-green {
            background: #2ecc71;
            color: white;
        }
        
        .color-blue {
            background: #3498db;
            color: white;
        }
        
        .color-yellow {
            background: #f1c40f;
            color: #333;
        }
        
        .color-cyan {
            background: #1abc9c;
            color: white;
        }
        
        .color-magenta {
            background: #9b59b6;
            color: white;
        }
        
        .examples {
            padding: 15px;
            background: #f8f9fa;
            border-top: 1px solid #eaeaea;
        }
        
        .example-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .example-item {
            padding: 8px 15px;
            background: #e9ecef;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .example-item:hover {
            background: #dee2e6;
            transform: translateY(-2px);
        }
        
        footer {
            text-align: center;
            padding: 15px;
            background: #f5f7fa;
            color: #6c757d;
            font-size: 14px;
            border-top: 1px solid #eaeaea;
        }
        
        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        /* è¿”å›æŒ‰é’®å®¹å™¨ */
        .back-btn-container {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 104px;
            display: flex;
            align-items: center;
            /* padding-left: 20px; */
            z-index: 1000;
            overflow: hidden;
        }

        /* è¿”å›æŒ‰é’®æ ·å¼ - ä¸headeråŒé«˜çš„æ­£æ–¹å½¢ */
        .back-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 104px; /* æ­£æ–¹å½¢è¾¹é•¿ï¼Œå¯æ ¹æ®headeré«˜åº¦è°ƒæ•´ */
            height: 112.2px; /* ä¸widthç›¸åŒä¿æŒæ­£æ–¹å½¢ */
            background: #2c3e50;
            /* border: 2px solid rgba(255,255,255,0.3); */
            /* border-radius: 12px; */
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        /* æŒ‰é’®æ‚¬åœæ•ˆæœ */
        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.2));
            border-color: rgba(255,255,255,0.5);
        }

        /* æŒ‰é’®æ¿€æ´»æ•ˆæœ */
        .back-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        /* æŒ‰é’®ä¼ªç±» - æµå…‰æ•ˆæœ */
        .back-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .back-btn:hover::before {
            left: 100%;
        }

        /* è¿”å›å›¾æ ‡æ ·å¼ */
        .back-icon {
            width: 40px;
            height: 40px;
            position: relative;
            transition: transform 0.3s ease;
        }

        /* å›¾æ ‡ä¼ªå…ƒç´  - ç®­å¤´ä¸»ä½“ */
        .back-icon::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 2px;
            background: white;
            transform: translateY(-50%);
        }

        /* å›¾æ ‡ä¼ªå…ƒç´  - ç®­å¤´å¤´éƒ¨ */
        .back-icon::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 12px;
            height: 12px;
            border-left: 2px solid white;
            border-bottom: 2px solid white;
            transform: translateY(-50%) rotate(45deg);
        }

        /* æ‚¬åœæ—¶å›¾æ ‡åŠ¨ç”» */
        .back-btn:hover .back-icon {
            transform: translateX(-3px);
        }

        /* ç¡®ä¿headeræœ‰ç›¸å¯¹å®šä½ä»¥ä¾¿ç»å¯¹å®šä½çš„æŒ‰é’®å®¹å™¨ */
        header {
            position: relative;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;  
                padding: 15px;
                gap: 15px;
            }

            .panel {
                min-width: unset; /* ç§»é™¤æœ€å°å®½åº¦é™åˆ¶ */
                width: 100%;
            }
            
            .editor-container, .console-output {
                height: 45vh; /* å°å±å¹•æ—¶é€‚å½“é™ä½é«˜åº¦ */
            }
            
            /* ç¡®ä¿é¢œè‰²æ§åˆ¶åŒºåŸŸåœ¨å°å±å¹•æ­£å¸¸æ˜¾ç¤º */
            .color-controls {
                height: auto;
                padding: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        /* è¶…å°å±å¹•è¿›ä¸€æ­¥ä¼˜åŒ– */
        @media (max-width: 480px) {
            .main-content {
                padding: 10px;
                gap: 10px;
            }
            
            .editor-container, .console-output {
                height: 40vh;
            }
            
            .panel-header {
                padding: 10px 12px;
                font-size: 14px;
            }
        }

        @media (max-width: 450px) {
            .clear-btn, .example-btn{
                padding: 10px 12px;
            }
            .back-icon {
                width: 20px;
                height: 20px;
            }
            .back-btn {
                width: 30px;
            }
            .subtitle, .panel-header {
                font-size: 14px;
            }
            .color-label {
                width: 100%;
            }
            .color-controls {
                height: 136px;
            }
        }

        /* é¢œè‰²æ§åˆ¶æŒ‰é’®æ ·å¼å“åº”å¼å˜åŒ– */
        /* @media (min-width: 769px) and (max-width: 1235px) {
            .color-btn { */
                /* å·¦å³å†…è¾¹è·ä»20pxç¼©å°åˆ°10pxï¼Œä¸Šä¸‹ä¿æŒ6pxä¸å˜ */
                /* padding: 6px 10px; 
            }
        } */

        /* åŸæœ‰å°å±å¹•æ ·å¼ä¿æŒä¸å˜ */
        /* @media (max-width: 768px) {
            .color-btn {
                padding: 6px 20px;
            }
        } */

    </style>
</head>
<body>
    <div class="container">
        <header>
            <!-- è¿”å›æŒ‰é’®å®¹å™¨ -->
            <div class="back-btn-container">
                <button class="back-btn" onclick="window.location.replace('/')" title="è¿”å›ä¸Šä¸€é¡µ">
                    <img alt="è¿”å›" src="/blogImgs/back_JSConsole.png" class="back-icon"></img>
                </button>
            </div>

            <h1>JavaScript è°ƒè¯•ç¯å¢ƒ</h1>
            <p class="subtitle">ç¼–å†™ã€æµ‹è¯•å’Œè°ƒè¯•æ‚¨çš„ JavaScript ä»£ç </p>
        </header>
        
        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <span>ä»£ç ç¼–è¾‘å™¨</span>
                    <span>Ctrl+Enter è¿è¡Œ | F1 ä»£ç æç¤º</span>
                </div>
                <div id="editorContainer" class="editor-container"></div>
                <div class="controls">
                    <button id="runBtn" class="run-btn">è¿è¡Œ</button>
                    <button id="clearHistoryBtn" class="clear-btn">æ¸…é™¤æ§åˆ¶å°</button>
                    <button id="exampleBtn" class="example-btn">æ¸…ç©ºç¼–è¾‘å™¨</button>
                </div>
                
                <div class="examples">
                    <p>å¿«é€Ÿç¤ºä¾‹:</p>
                    <div class="example-list">
                        <div class="example-item" data-example="sort">æ’åºç¤ºä¾‹</div>
                        <div class="example-item" data-example="dom">DOMæ“ä½œ</div>
                        <div class="example-item" data-example="ajax">AJAXè¯·æ±‚</div>
                        <div class="example-item" data-example="class">ç±»ä¸å¯¹è±¡</div>
                        <div class="example-item" data-example="async">å¼‚æ­¥ç¼–ç¨‹</div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <span>æ§åˆ¶å°è¾“å‡º</span>
                    <span>å®æ—¶æ˜¾ç¤ºç»“æœ</span>
                </div>
                <div id="consoleOutput" class="console-output" aria-live="polite"></div>
                
                <!-- æ–°å¢é¢œè‰²æ§åˆ¶åŒºåŸŸ -->
                <div class="color-controls">
                    <span class="color-label">è¾“å‡ºé¢œè‰²:</span>
                    <button class="color-btn color-white active" data-color="#ffffff">ç™½è‰²</button>
                    <button class="color-btn color-green" data-color="#2ecc71">ç»¿è‰²</button>
                    <button class="color-btn color-blue" data-color="#3498db">è“è‰²</button>
                    <button class="color-btn color-yellow" data-color="#f1c40f">é»„è‰²</button>
                    <button class="color-btn color-cyan" data-color="#1abc9c">é’è‰²</button>
                    <button class="color-btn color-magenta" data-color="#9b59b6">ç´«è‰²</button>
                </div>
            </div>
        </div>
        
        <footer>
            <!-- [äº§å“] by [ä½œè€…] Â© [å¹´ä»½] | [æŠ€æœ¯æ ˆ] -->
            <p>JavaScript è°ƒè¯•ç¯å¢ƒ &copy; 2025 By tong | åŸºäº Monaco Editor æ„å»º</p>
        </footer>
    </div>

    <!-- å¼•å…¥ Monaco Editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    
    <script>
        // è·å–DOMå…ƒç´ 
        const consoleOutput = document.getElementById('consoleOutput');
        const runBtn = document.getElementById('runBtn');
        const exampleBtn = document.getElementById('exampleBtn');
        const exampleItems = document.querySelectorAll('.example-item');
        const colorButtons = document.querySelectorAll('.color-btn');
        
        let editor; // Monaco ç¼–è¾‘å™¨å®ä¾‹
        let currentColor = '#ffffff'; // é»˜è®¤ç™½è‰²
        
        // é‡å†™console.logä»¥åœ¨é¡µé¢æ˜¾ç¤ºè¾“å‡º
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        const originalConsoleInfo = console.info;
        
        // ç®¡ç†è¿è¡Œå—ï¼ˆæ¯æ¬¡è¿è¡Œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æŠ˜å é¢æ¿ï¼‰ï¼Œä½¿ç”¨â€œ--- è¿è¡Œå¼€å§‹ --- / --- è¿è¡Œç»“æŸ ---â€æ–‡æœ¬è¾¹ç•Œ
        let currentRunId = null;

        /* CSS åŠ¨ç”»ç›¸å…³ï¼šä½¿ç”¨ collapsed ç±»æ§åˆ¶ body ä¸ end çš„æ˜¾ç¤º */
        // åˆ›å»º run blockï¼Œç»“æ„ï¼š
        // <div class="run-block" id>
        //   <div class="run-start">--- è¿è¡Œå¼€å§‹: ts --- <span class="run-controls">[æŠ˜å ][åˆ é™¤]</span></div>
        //   <div class="run-block-body">...</div>
        //   <div class="run-end">--- è¿è¡Œç»“æŸ: ts ---</div>
        // </div>
        function createRunBlock() {
            // åˆ›å»ºå”¯ä¸€æ ‡è¯†å’Œå®¹å™¨
            const id = 'run-' + Date.now();
            const runBlock = document.createElement('div');
            runBlock.className = 'run-block';
            runBlock.id = id;

            // åˆ›å»ºå¼€å§‹è¡Œ
            const ts = new Date().toLocaleString();

            const startLine = document.createElement('div');
            startLine.className = 'run-start';

            const timeTxt = document.createElement('div');
            timeTxt.className = 'run-timeTxt';
            timeTxt.innerHTML = ` --- ${ts} ---`;
            startLine.appendChild(timeTxt);

            // åˆ›å»ºæ§åˆ¶æŒ‰é’®
            const controls = document.createElement('span');
            controls.className = 'run-controls';
            controls.style.marginLeft = '10px';

            const collapseBtn = document.createElement('button');
            collapseBtn.className = 'collapse-btn';
            collapseBtn.textContent = 'æŠ˜å ';
            collapseBtn.onclick = () => toggleCollapse(id, collapseBtn);

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.textContent = 'åˆ é™¤';
            deleteBtn.onclick = () => runBlock.remove();

            controls.appendChild(collapseBtn);
            controls.appendChild(deleteBtn);
            startLine.appendChild(controls);

            // åˆ›å»ºå†…å®¹åŒºåŸŸ
            const body = document.createElement('div');
            body.className = 'run-block-body';
            body.textContent = '';

            const endLine = document.createElement('div');
            endLine.className = 'run-block-line run-end';
            // endLine.textContent = `--- è¿è¡Œç»“æŸ: ${ts} ---`;

            // ç»„è£…å¹¶æ’å…¥DOM
            runBlock.appendChild(startLine);
            runBlock.appendChild(body);
            runBlock.appendChild(endLine);

            consoleOutput.appendChild(runBlock);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;

            currentRunId = id;
            return id;
        }

        function getRunBodyById(id) {
            const blk = document.getElementById(id);
            return blk ? blk.querySelector('.run-block-body') : null;
        }

        function appendToCurrentRun(text, color) {
            if (!currentRunId || !document.getElementById(currentRunId)) {
                createRunBlock();
            }
            const body = getRunBodyById(currentRunId);
            if (!body) return;
            const line = document.createElement('div');
            if (color) line.style.color = color;
            line.textContent = text;
            body.appendChild(line);
            body.scrollTop = body.scrollHeight;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        function addOutput(type, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const output = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)).join(' ');
            let outputColor;
            switch(type) {
                case 'log': outputColor = currentColor; break;
                case 'error': outputColor = '#ff4444'; break;
                case 'warn': outputColor = '#ffaa00'; break;
                case 'info': outputColor = '#4488ff'; break;
                default: outputColor = currentColor;
            }
            appendToCurrentRun(`[${timestamp}] ${type.toUpperCase()}: ${output}`, outputColor);
        }

        console.log = (...args) => { originalConsoleLog.apply(console, args); addOutput('log', ...args); };
        console.error = (...args) => { originalConsoleError.apply(console, args); addOutput('error', ...args); };
        console.warn = (...args) => { originalConsoleWarn.apply(console, args); addOutput('warn', ...args); };
        console.info = (...args) => { originalConsoleInfo.apply(console, args); addOutput('info', ...args); };

        // æŠ˜å /å±•å¼€ï¼Œå¸¦åŠ¨ç”»ï¼Œå¹¶åˆ‡æ¢æŒ‰é’®æ–‡æœ¬
        function toggleCollapse(runId, btn) {
            const blk = document.getElementById(runId);
            if (!blk) return;
            const body = blk.querySelector('.run-block-body');
            const end = blk.querySelector('.run-end');
            const isCollapsed = body.classList.toggle('collapsed');
            if (end) end.classList.toggle('collapsed');
            // åˆ‡æ¢æŒ‰é’®æ–‡æœ¬
            if (btn) btn.textContent = isCollapsed ? 'å±•å¼€' : 'æŠ˜å ';
        }
        
        // é¢œè‰²æ§åˆ¶åŠŸèƒ½
        function setOutputColor(color) {
            currentColor = color;
            
            // æ›´æ–°æŒ‰é’®æ¿€æ´»çŠ¶æ€
            colorButtons.forEach(btn => {
                if (btn.getAttribute('data-color') === color) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            console.log(`è¾“å‡ºé¢œè‰²å·²åˆ‡æ¢ä¸º: ${color}`);
        }
        
        // åˆå§‹åŒ– Monaco Editor
        function initEditor() {
            require.config({ 
                paths: { 
                    'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' 
                } 
            });
            
            require(['vs/editor/editor.main'], function() {
                // åˆ›å»ºç¼–è¾‘å™¨
                editor = monaco.editor.create(document.getElementById('editorContainer'), {
                    value: 
`// æ¬¢è¿ä½¿ç”¨ JavaScript è°ƒè¯•ç¯å¢ƒ
// ç‚¹å‡»"è¿è¡Œä»£ç "æˆ–æŒ‰ Ctrl+Enter æ‰§è¡Œä»£ç 

// ç¤ºä¾‹ï¼šè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}

console.log("æ–æ³¢é‚£å¥‘æ•°åˆ—å‰10é¡¹:");
for (let i = 0; i < 10; i++) {
    console.log(\`fib(\${i}) = \${fibonacci(i)}\`);
}`,
                    language: 'javascript',
                    theme: 'vs-dark',
                    fontSize: 14,
                    lineNumbers: 'on',
                    roundedSelection: true,
                    scrollBeyondLastLine: false,
                    readOnly: false,
                    cursorStyle: 'line',
                    automaticLayout: true,
                    minimap: { enabled: true },
                    suggestOnTriggerCharacters: true,
                    quickSuggestions: true,
                    parameterHints: { enabled: true }
                });
                
                // æ·»åŠ é”®ç›˜å¿«æ·é”®
                editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, function() {
                    runCode();
                });

                // ğŸ†• æ–°å¢ï¼šæ·»åŠ å¿«æ·é”®æ’å…¥æ—¥å¿—åŠŸèƒ½
                initEmojiLog();

                console.log("ğŸš€ ä»£ç ç¼–è¾‘å™¨å·²åŠ è½½å®Œæˆï¼");
            }, function(error) {
                console.error('Monaco Editor åŠ è½½å¤±è´¥:', error);
            });
        }
        
        // è¿è¡Œä»£ç ï¼šæ¯æ¬¡è¿è¡Œåˆ›å»ºæ–°çš„è¿è¡Œå—å¹¶å°†æ—¥å¿—è·¯ç”±åˆ°è¯¥å—
        function runCode() {
            try {
                // åˆ›å»ºæ–°çš„è¿è¡Œå—å¹¶è®¾ç½®ä¸ºå½“å‰
                createRunBlock();
                const code = editor.getValue();
                eval(code);
            } catch (error) {
                console.error('æ‰§è¡Œé”™è¯¯:', error.message);
            }
        }
        
        // æ¸…é™¤æ§åˆ¶å°
        function clearHistory() {
            consoleOutput.innerHTML = '';
            currentRunId = null;
        }
        
        // æ¸…ç©ºç¼–è¾‘å™¨
        function clearEditor() {
            if (editor) {
                editor.setValue('// ç¼–è¾‘å™¨å·²æ¸…ç©º\n// å¼€å§‹ç¼–å†™ä½ çš„ JavaScript ä»£ç å§ï¼\n\n');
                console.log("âœ… ç¼–è¾‘å™¨å·²æ¸…ç©º");
            }
        }

        // åŠ è½½ç¤ºä¾‹ä»£ç 
        function loadExample(exampleName) {
            const examples = {
                sort:  
`// æ•°ç»„æ’åºç¤ºä¾‹
const numbers = [3, 1, 4, 1, 5, 9, 2, 6, 5];
console.log("åŸå§‹æ•°ç»„:", numbers);

// å‡åºæ’åº
const ascending = [...numbers].sort((a, b) => a - b);
console.log("å‡åºæ’åº:", ascending);

// é™åºæ’åº
const descending = [...numbers].sort((a, b) => b - a);
console.log("é™åºæ’åº:", descending);

// å­—ç¬¦ä¸²æ•°ç»„æ’åº
const fruits = ["é¦™è•‰", "è‹¹æœ", "æ©™å­", "è‘¡è„"];
console.log("æ°´æœæ’åº:", fruits.sort());

// å¯¹è±¡æ•°ç»„æ’åº
const users = [
    { name: "å¼ ä¸‰", age: 25 },
    { name: "æå››", age: 30 },
    { name: "ç‹äº”", age: 20 }
];
const sortedByAge = [...users].sort((a, b) => a.age - b.age);
console.log("æŒ‰å¹´é¾„æ’åº:", sortedByAge);`,
                
                dom:   
`// DOMæ“ä½œç¤ºä¾‹
console.log("å½“å‰é¡µé¢æ ‡é¢˜:", document.title);

// åˆ›å»ºå…ƒç´ 
const newElement = document.createElement('div');
newElement.textContent = "è¿™æ˜¯é€šè¿‡JavaScriptåˆ›å»ºçš„å…ƒç´ ";
newElement.style.cssText = 'padding: 10px; background: #e3f2fd; margin: 10px 0; border-radius: 5px;';
document.body.appendChild(newElement);

// ä¿®æ”¹æ ·å¼
document.querySelector('.container').style.border = '2px solid #3498db';

console.log("DOMæ“ä½œå®Œæˆï¼");`,
                
                ajax:  
`// æ¨¡æ‹ŸAJAXè¯·æ±‚
console.log("å¼€å§‹æ¨¡æ‹ŸAJAXè¯·æ±‚...");

// ä½¿ç”¨Promiseæ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚
function fakeApiCall(url) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (url === '/api/users') {
                resolve({
                    status: 200,
                    data: [
                        { id: 1, name: 'å¼ ä¸‰', email: 'zhangsan@example.com' },
                        { id: 2, name: 'æå››', email: 'lisi@example.com' }
                    ]
                });
            } else {
                reject({ status: 404, message: 'æ¥å£ä¸å­˜åœ¨' });
            }
        }, 1000);
    });
}

// è°ƒç”¨æ¨¡æ‹ŸAPI
fakeApiCall('/api/users')
    .then(response => {
        console.log('è¯·æ±‚æˆåŠŸ:', response);
    })
    .catch(error => {
        console.log('è¯·æ±‚å¤±è´¥:', error);
    });`,
                
                class: 
`// ç±»ä¸å¯¹è±¡ç¤ºä¾‹
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    introduce() {
        return \`å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯\${this.name}ï¼Œä»Šå¹´\${this.age}å²\`;
    }
    
    static compareAge(person1, person2) {
        return person1.age - person2.age;
    }
}

// åˆ›å»ºå®ä¾‹
const person1 = new Person('å¼ ä¸‰', 25);
const person2 = new Person('æå››', 30);

console.log(person1.introduce());
console.log(person2.introduce());
console.log(\"å¹´é¾„å·®:\", Person.compareAge(person1, person2));

// ç»§æ‰¿
class Student extends Person {
    constructor(name, age, major) {
        super(name, age);
        this.major = major;
    }
    
    introduce() {
        return \`\${super.introduce()}ï¼Œä¸“ä¸šæ˜¯\${this.major}\`;
    }
}

const student = new Student('ç‹äº”', 20, 'è®¡ç®—æœºç§‘å­¦');
console.log(student.introduce());`,
                
                async: 
`// å¼‚æ­¥ç¼–ç¨‹ç¤ºä¾‹
console.log("å¼€å§‹å¼‚æ­¥æ“ä½œæ¼”ç¤º...");

// async/await ç¤ºä¾‹
async function fetchUserData(userId) {
    console.log(\`å¼€å§‹è·å–ç”¨æˆ· \${userId} çš„æ•°æ®...\`);
    
    // æ¨¡æ‹ŸAPIè°ƒç”¨
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({
                id: userId,
                name: \`ç”¨æˆ·\${userId}\`,
                email: \`user\${userId}@example.com\`
            });
        }, 1000);
    });
}

// å¹¶è¡Œè¯·æ±‚
async function getMultipleUsers() {
    try {
        console.log("å¼€å§‹å¹¶è¡Œè·å–å¤šä¸ªç”¨æˆ·...");
        
        const [user1, user2, user3] = await Promise.all([
            fetchUserData(1),
            fetchUserData(2),
            fetchUserData(3)
        ]);
        
        console.log("æ‰€æœ‰ç”¨æˆ·æ•°æ®:", { user1, user2, user3 });
        console.log("å¼‚æ­¥æ“ä½œå®Œæˆï¼");
        
    } catch (error) {
        console.error("è·å–ç”¨æˆ·æ•°æ®å¤±è´¥:", error);
    }
}

// æ‰§è¡Œå¼‚æ­¥å‡½æ•°
getMultipleUsers();`,
            };
            
            if (examples[exampleName] && editor) {
                editor.setValue(examples[exampleName]);
            }
        }
        
    // äº‹ä»¶ç›‘å¬
    runBtn.addEventListener('click', runCode);

    const clearHistoryBtn = document.getElementById('clearHistoryBtn');
    if (clearHistoryBtn) clearHistoryBtn.addEventListener('click', clearHistory);
    exampleBtn.addEventListener('click', clearEditor);
        
        // ç¤ºä¾‹é¡¹ç‚¹å‡»äº‹ä»¶
        exampleItems.forEach(item => {
            item.addEventListener('click', () => {
                const exampleName = item.getAttribute('data-example');
                loadExample(exampleName);
            });
        });
        
        // é¢œè‰²æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        colorButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const color = btn.getAttribute('data-color');
                setOutputColor(color);
            });
        });
        
        // åˆå§‹åŒ–ç¼–è¾‘å™¨
        console.log("â³ æ­£åœ¨åŠ è½½ä»£ç ç¼–è¾‘å™¨...");
        initEditor();
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('load', () => {
            console.log("âœ… JavaScriptè°ƒè¯•ç¯å¢ƒå·²å°±ç»ªï¼");
            console.log("ğŸ¯ ç‰¹æ€§ï¼šè¯­æ³•é«˜äº®ã€æ™ºèƒ½æç¤ºã€é”™è¯¯æ£€æŸ¥ã€å¿«æ·é”®æ”¯æŒ");
            console.log("ğŸ¨ ç°åœ¨å¯ä»¥ç‚¹å‡»é¢œè‰²æŒ‰é’®åˆ‡æ¢è¾“å‡ºé¢œè‰²ï¼");
            console.log("âš¡ æ–°å¢åŠŸèƒ½ï¼šCtrl+Shift+Alt+E æ’å…¥emojiæ—¥å¿—");
            console.log("ğŸ’¡ æç¤ºï¼šé”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ä¼šä¿æŒå›ºå®šé¢œè‰²ï¼Œåªæœ‰æ™®é€šæ—¥å¿—ä¼šæ”¹å˜é¢œè‰²");
        });

        // ğŸ†• æ–°å¢ï¼šemojiæ—¥å¿—åŠŸèƒ½å‡½æ•°
        function initEmojiLog() {
            // Emoji å¾ªç¯åˆ—è¡¨
            const emojiList = ['ğŸ’¬', 'â­', 'ğŸŒŸ', 'ğŸ’«', 'âœ¨', 'âš¡', 'ğŸ’¥', 'ğŸ”¥', 'ğŸ’§', 'ğŸŒˆ', 'ğŸ“Œ', 'ğŸ“', 'ğŸ”', 'ğŸ”', 'ğŸ’¡', 'ğŸ””', 'ğŸ“¢', 'ğŸ“£', 'ğŸ”Š', 'ğŸ”•' ,  'ğŸ¯', 'ğŸ›', 'ğŸ“', 'ğŸ“', 'ğŸ“‹', 'ğŸ“Œ', 'ğŸ“', 'ğŸ”–', 'ğŸ“', 'ğŸ“', 'ğŸ“', 'âœ‚ï¸', 'ğŸ“‚'];
            let currentEmojiIndex = 0;
            
            // æ³¨å†Œå¿«æ·é”®
            editor.addCommand(
                monaco.KeyMod.CtrlCmd | monaco.KeyMod.Shift | monaco.KeyMod.Alt | monaco.KeyCode.KeyE, 
                function() {
                    insertEmojiLog(emojiList, currentEmojiIndex);
                    // æ›´æ–°ç´¢å¼•
                    currentEmojiIndex = (currentEmojiIndex + 1) % emojiList.length;
                }
            );
        }

        // ğŸ†• æ–°å¢ï¼šæ’å…¥emojiæ—¥å¿—çš„æ ¸å¿ƒå‡½æ•°
        function insertEmojiLog(emojiList, currentIndex) {
            const selection = editor.getSelection();
            const model = editor.getModel();
            
            // è·å–å½“å‰é€‰ä¸­çš„æ–‡æœ¬ï¼Œå¦‚æœæ²¡æœ‰é€‰ä¸­åˆ™ä½¿ç”¨é»˜è®¤çš„ 'data'
            let variableName = 'data';
            if (!selection.isEmpty()) {
                variableName = model.getValueInRange(selection);
            }
            
            // è·å–å½“å‰emoji
            const currentEmoji = emojiList[currentIndex];
            
            // æ„å»ºæ—¥å¿—è¯­å¥
            const logStatement = `console.log("${currentEmoji} ${variableName}:", ${variableName});\n`;
            
            // åœ¨å½“å‰é€‰ä¸­è¡Œçš„ä¸‹ä¸€è¡Œæ’å…¥
            const insertLineNumber = selection.endLineNumber + 1;
            const insertColumn = 1;
            
            editor.executeEdits("insert-emoji-log", [{
                range: new monaco.Range(insertLineNumber, insertColumn, insertLineNumber, insertColumn),
                text: logStatement
            }]);
            
            // å°†å…‰æ ‡ç§»åŠ¨åˆ°æ–°æ’å…¥çš„è¯­å¥åé¢
            const newPosition = new monaco.Position(insertLineNumber, logStatement.length);
            editor.setPosition(newPosition);
            editor.focus();
        }
        // function addLogShortcuts() {
        //     // Ctrl+Shift+L æ’å…¥æ™®é€šæ—¥å¿—
        //     editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyMod.Shift | monaco.KeyCode.KeyE, function() {
        //         insertLogStatement('log');
        //     });
            
        //     // Ctrl+Shift+E æ’å…¥é”™è¯¯æ—¥å¿—
        //     editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyMod.Shift | monaco.KeyCode.KeyZ, function() {
        //         insertLogStatement('error');
        //     });
            
        //     // Ctrl+Shift+W æ’å…¥è­¦å‘Šæ—¥å¿—
        //     editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyMod.Shift | monaco.KeyCode.KeyF, function() {
        //         insertLogStatement('warn');
        //     });
            
        //     // Ctrl+Shift+S æ’å…¥æˆåŠŸæ—¥å¿—
        //     editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyMod.Shift | monaco.KeyCode.KeyV, function() {
        //         insertLogStatement('success');
        //     });
        // }

        // // æ’å…¥æ—¥å¿—è¯­å¥çš„æ ¸å¿ƒå‡½æ•°
        // function insertLogStatement(type = 'log') {
        //     const selection = editor.getSelection();
        //     const model = editor.getModel();
            
        //     // è¡¨æƒ…ç¬¦å·æ˜ å°„
        //     const emojiMap = {
        //         log: 'ğŸ’¬',
        //         error: 'ğŸ”´',
        //         warn: 'ğŸŸ¡', 
        //         success: 'ğŸŸ¢',
        //         info: 'ğŸ”µ'
        //     };
            
        //     // è·å–å½“å‰é€‰ä¸­çš„æ–‡æœ¬ï¼ˆå˜é‡åï¼‰
        //     let variableName = '';
        //     if (!selection.isEmpty()) {
        //         variableName = model.getValueInRange(selection);
        //     } else {
        //         // å¦‚æœæ²¡æœ‰é€‰ä¸­æ–‡æœ¬ï¼Œè‡ªåŠ¨ç”Ÿæˆå˜é‡å
        //         variableName = 'data';
        //     }
            
        //     const emoji = emojiMap[type] || 'ğŸ’¬';
        //     let logStatement;
            
        //     if (type === 'success') {
        //         logStatement = `console.log("${emoji} ${variableName}:", ${variableName});`;
        //     } else {
        //         logStatement = `console.${type}("${emoji} ${variableName}:", ${variableName});`;
        //     }
            
        //     // åœ¨å½“å‰è¡Œä¸‹æ–¹æ’å…¥æ—¥å¿—è¯­å¥
        //     const insertLineNumber = selection.endLineNumber + 1;
        //     const insertColumn = 1;
            
        //     editor.executeEdits("insert-log", [{
        //         range: new monaco.Range(insertLineNumber, insertColumn, insertLineNumber, insertColumn),
        //         text: logStatement + '\n'
        //     }]);
            
        //     // å°†å…‰æ ‡ç§»åŠ¨åˆ°æ–°æ’å…¥çš„è¯­å¥åé¢
        //     const newPosition = new monaco.Position(insertLineNumber + 1, 1);
        //     editor.setPosition(newPosition);
        //     editor.focus();
        // }
    </script>
</body>
</html>